<html>
<head>    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/w3.css">
    <link rel="stylesheet" href="/css/w3-theme-black.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <title>{{ campname }} Announcement Editor</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"> </script>
    <script>if (!window.jQuery) { document.write('<script src="/js/jquery-3.1.1.min.js"><\/script>'); }</script>
    <script>

        /* this script handles creating public events. */
        
        $(document).ready(function () {

            //run when user clicks the submit button
            $("#submit_button").click(function () {
                console.log('Submit button pressed');
                request = {};
                request.content = $("#announcement_text").val();
                console.log('Pushing the event to the server for processing:');
                console.log(request);
                $.ajax({
                    //make a POST AJAX query to the same web page as the user is currently visiting
                    url: (window.location.href),
                    type: 'POST',
                    contentType: 'application/json;charset=UTF-8',
                    data: JSON.stringify(request, null),
                    success: function (data) {
                        //upon success, the server will return a message and a URL. give the user the message and send them to the URL.
                        console.log(data);
                        if (data.message != 'none') {
                            confirm(data.message);
                        }
                        if (data.url != 'none') {
                            window.location = data.url;
                        }
                    }
                });
            });
        });
    </script>
</head>

<body>
    <!-- Navbar -->
    <div class="w3-top">
        <ul class="w3-navbar w3-theme w3-top w3-left-align w3-large">
            <li><a href="#" class="w3-theme-l1">Announcement Editor</a></li>
            <li><a href="/user/{{ thisuser.userid }}/" class="w3-hover-white">Dashboard</a></li>
        </ul>
    </div>
    <!-- Body -->
    <div class="w3-row">
        <div class="w3-container">
            <p>
                This page is used to edit the announcement that shows up on all user dashboards.
            </p>
            <p><textarea id="announcement_text" cols="40" rows="5">{{ currentannouncement.content }}</textarea></p>
        </div>
    </div>
    <!-- Navbar -->
    <div class="w3-bottom">
        <ul class="w3-navbar w3-theme w3-bottom w3-left-align w3-large">
            <li><a href="#" class="w3-hover-white" id="submit_button">Submit</a></li>
        </ul>
    </div>
</body>
</html>